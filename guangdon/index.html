<!--
 * @Description:
 * @version:
 * @Author: zouwenqin
 * @Date: 2021-06-02 22:27:16
 * @LastEditors: zouwenqin
 * @LastEditTime: 2021-07-30 11:23:11
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>广东3D地图</title>
    <style>
        #map {
            width: 100%;
            height: 700px;
        }
    </style>
    <script src="./jquery-3.5.1.min.js"></script>
    <script src="./echarts.min.js"></script>
    <script src="./echarts-gl.min.js"></script>
    <script src="./bmap.min.js"></script>
</head>

<body>
    <p>文字</p>
    <div id="map"></div>
    <script>
        const coordinateArr = {
            '广州市': [113.280637, 23.125178],
            '韶关市': [113.591544, 24.801322],
            '深圳市': [114.085947, 22.547],
            '珠海市': [113.553986, 22.224979],
            '汕头市': [116.708463, 23.37102],
            '佛山市': [113.122717, 23.028762],
            '江门市': [113.094942, 22.590431],
            '湛江市': [110.364977, 21.274898],
            '茂名市': [110.919229, 21.659751],
            '肇庆市': [112.472529, 23.051546],
            '惠州市': [114.412599, 23.079404],
            '梅州市': [116.117582, 24.299112],
            '汕尾市': [115.364238, 22.774485],
            '河源市': [114.697802, 23.746266],
            '阳江市': [111.975107, 21.859222],
            '清远市': [113.051227, 23.685022],
            '东莞市': [113.746262, 23.046237],
            '中山市': [113.382391, 22.521113],
            '潮州市': [116.632301, 23.661701],
            '揭阳市': [116.355733, 23.543778],
            '云浮市': [112.044439, 22.929801]
        };

        const regionData = [{
            name: '广州市',
            value: 10000
        },{
            name: '韶关市',
            value: 4000
        },{
            name: '深圳市',
            value: 500
        },{
            name: '珠海市',
            value: 500
        },{
            name: '汕头市',
            value: 100
        },{
            name: '汕头市',
            value: 100
        },{
            name: '佛山市',
            value: 600,
        },{
            name: '江门市',
            value: 2000,
        },{
            name: '湛江市',
            value: 5000
        },{
            name: '茂名市',
            value: 6000
        },{
            name: '肇庆市',
            value: 7000
        },{
            name: '汕尾市',
            value: 8000
        },{
            name: '东莞市',
            value: 12000
        }]

        const convertData = function (data) {
            let res = [];
            for (let i = 0; i < data.length; i++) {
                console.log(data[i].name);
                let geoCoord = coordinateArr[data[i].name];
                if (geoCoord) {
                    res.push({
                        name: data[i].name,
                        value: geoCoord.concat(data[i].value)
                    });
                }
            }
            return res;
        };
        console.log(convertData(regionData));
        $.get('./guangdon.json', geoJson => {
            echarts.registerMap('guangdon', geoJson);
            const resData = convertData(regionData);
            const option = {
                geo3D: {
                    map: 'guangdon',
                    roam: true,
                    itemStyle: {

                        areaColor: '#ccc',
                        opacity: 1,
                        borderWidth: 0.8,
                        borderColor: 'rgb(242,231,229)'
                    },
                    label: {
                        show: true,
                        textStyle:{
                            fontSize: 20
                        }
                    },
                    emphasis: { //当鼠标放上去  地区区域是否显示名称
                        label: {
                            show: true,
                            textStyle: {
                                color: 'black',
                                fontSize: 20,
                                backgroundColor: 'rgba(41,97,49,0)'
                            }
                        }
                    },
                    // 配置环境贴图
                    environment: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                        offset: 0, color: '#0F2027' // 天空颜色
                    }, {
                        offset: 0.7, color: '#203A43' // 地面颜色
                    }, {
                        offset: 1, color: '#2C5364' // 地面颜色
                    }], false),
                    // 光照
                    light: {
                        main: {
                            color: '#c27c88', //光照颜色
                            intensity: 1.2, //光照强度
                            shadowQuality: 'high', //阴影亮度
                            shadow: true, //是否显示阴影
                            beta: 100

                        },
                        ambient: {
                            intensity: 0.3
                        }
                    },
                    // 后处理特效
                    postEffect: {
                        enable: true,
                        // 高光效果
                        bloom: {
                            enable: true,
                            bloomIntensity: 0.5
                        },
                        // 景深
                        depthOfField: {
                            enable: false,
                            focalDistance: 90,
                            focalRange: 60,
                            fstop: 2.8,
                            blurRadius: 10
                        },
                    },
                    shading: 'realistic',
                    // 鼠标旋转，控制
                    viewControl: {
                        autoRotate: false,
                        damping: 0.9
                    },
                    // 配置地图材质
                    realisticMaterial: {
                        roughness: 1,
                        textureTiling: 20,
                        detailTexture: './woods.jpg'
                    },
                },
                series: [{
                    name: 'bar3D',
                    type: "bar3D",
                    coordinateSystem: 'geo3D',
                    barSize: 2, //柱子粗细
                    shading: 'realistic',
                    opacity: 0.5,
                    bevelSize: 0,
                    bevelSmoothness: 100,
                    label: {
                        show: true,
                        formatter: data => data.name + " " + data.value[2],
                        textStyle: {
                            color: 'black',
                            fontWeight: '800',
                            backgroundColor: '#d2b116',

                        }
                    },
                    itemStyle: {
                        color: '#ddc871'
                    },
                    data: resData,
                    bevelSmoothness: 10,
                    zlevel: -10,
                    animation: true,
                    animationDurationUpdate: 500,
                    animationEasingUpdate: 'cubicOut'
                }]
            }
            const mycharts = echarts.init(document.querySelector('#map'));
            mycharts.setOption(option);
            mycharts.on('click', params => {
                console.log(params);
            })
        })
    </script>
</body>

</html>
